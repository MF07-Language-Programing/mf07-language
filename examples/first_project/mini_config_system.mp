# Mini Sistema de ConfiguraÃ§Ã£o Simplificado com JSON e .env

async intent main() {
    print("ğŸš€ Mini Sistema de ConfiguraÃ§Ã£o\n")
    
    # Setup diretÃ³rio
    var root = f"{Path.cwd()}/tests/config_demo"
    var workdir = new Directory(root)
    if (not workdir.exists()) {
        workdir.ensure()
    }
    
    # 1. Criar configuraÃ§Ã£o JSON
    print("ğŸ“ Etapa 1: Criando config.json...")
    var config = {
        "app": {
            "name": "MiniSystem",
            "version": "1.0.0",
            "debug": false
        },
        "database": {
            "host": "localhost",
            "port": 5432,
            "name": "minisystem_db"
        },
        "features": {
            "cache_enabled": true,
            "max_upload_mb": 10
        }
    }
    
    var configPath = f"{root}/config.json"
    with open(configPath, "w") as f {
        var jsonStr = JSON.stringify(config, indent=2)
        await f.writeText(jsonStr, null)
    }
    print(f"âœ“ Config salvo em: {configPath}")
    
    # 2. Criar arquivo .env
    print("\nğŸ“ Etapa 2: Criando .env...")
    var envPath = f"{root}/.env"
    var envContent = "# Database\nDB_HOST=localhost\nDB_PORT=5432\n\n# App\nAPP_ENV=development\nDEBUG=true\n"
    with open(envPath, "w") as f {
        await f.writeText(envContent, null)
    }
    print(f"âœ“ .env salvo em: {envPath}")
    
    # 3. Ler configuraÃ§Ã£o
    print("\nğŸ“ Etapa 3: Lendo config.json...")
    with open(configPath, "r") as f {
        var content = await f.readText("")
        var loadedConfig = JSON.parse(content)
        print("âœ“ ConfiguraÃ§Ã£o carregada:")
        print(JSON.stringify(loadedConfig, indent=2))
    }
    
    # 4. Ler variÃ¡veis .env
    print("\nğŸ“ Etapa 4: Lendo .env...")
    var envVars = {}
    with open(envPath, "r") as f {
        var envLines = await f.readText("")
        print(f"âœ“ VariÃ¡veis de ambiente carregadas")
        print(envLines)
    }
    
    # 5. Demonstrar uso de break em loop
    print("\nğŸ“ Etapa 5: Testando break em while...")
    var count = 0
    while (count < 100) {
        count = count + 1
        if (count == 5) {
            print(f"âœ“ Break funcionou! Saindo no count={count}")
            break
        }
    }
    
    print("\nâœ… Sistema de configuraÃ§Ã£o concluÃ­do com sucesso!")
}

print("=" * 60)
await main()
print("=" * 60)
